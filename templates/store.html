{% extends "base.html" %}

{% block content %}

{% if popup_message %}
<div id="notifModal" class="notif-modal">
    <div class="notif-box modal-animate">
        <h2 class="notif-title">Notification</h2>
        <p class="notif-text">{{ popup_message }}</p>
        <button class="notif-btn" onclick="closeNotif()">OK</button>
    </div>
</div>
{% endif %}

<section class="store-section">
    <h1 class="store-title">FightZone Store</h1>

    <div class="store-grid">

        <!-- Product 1 -->
        <div class="store-card">
            <img src="{{ url_for('static', filename='images/gloves.jpg') }}" class="store-pic">
            <h3>Pro Boxing Gloves</h3>
            <p class="price">‚Ç±2,499</p>
            <button class="store-btn" onclick="openPayment('Pro Boxing Gloves', 2499)">Buy Now</button>
        </div>

        <!-- Product 2 -->
        <div class="store-card">
            <img src="{{ url_for('static', filename='images/shirts.jpg') }}" class="store-pic">
            <h3>FightZone Shirt</h3>
            <p class="price">‚Ç±899</p>
            <button class="store-btn" onclick="openPayment('FightZone Shirt', 899)">Buy Now</button>
        </div>

        <!-- Product 3 -->
        <div class="store-card">
            <img src="{{ url_for('static', filename='images/handwraps.jpg') }}" class="store-pic">
            <h3>Hand Wraps</h3>
            <p class="price">‚Ç±299</p>
            <button class="store-btn" onclick="openPayment('Hand Wraps', 299)">Buy Now</button>
        </div>

        <!-- Product 4 -->
        <div class="store-card">
            <img src="{{ url_for('static', filename='images/jumprope.jpg') }}" class="store-pic">
            <h3>Jump Rope</h3>
            <p class="price">‚Ç±499</p>
            <button class="store-btn" onclick="openPayment('Jump Rope', 499)">Buy Now</button>
        </div>

        <!-- Product 5 -->
        <div class="store-card">
            <img src="{{ url_for('static', filename='images/mittpads.jpg') }}" class="store-pic">
            <h3>Mitt Pads</h3>
            <p class="price">‚Ç±1,299</p>
            <button class="store-btn" onclick="openPayment('Mitt Pads', 1299)">Buy Now</button>
        </div>

        <!-- Product 6 -->
        <div class="store-card">
            <img src="{{ url_for('static', filename='images/mouthguard.jpg') }}" class="store-pic">
            <h3>Mouth Guard</h3>
            <p class="price">‚Ç±199</p>
            <button class="store-btn" onclick="openPayment('Mouth Guard', 199)">Buy Now</button>
        </div>

        <!-- Product 7 -->
        <div class="store-card">
            <img src="{{ url_for('static', filename='images/wallbag.jpg') }}" class="store-pic">
            <h3>Wall Bag</h3>
            <p class="price">‚Ç±2,999</p>
            <button class="store-btn" onclick="openPayment('Wall Bag', 2999)">Buy Now</button>
        </div>

        <!-- Product 8 -->
        <div class="store-card">
            <img src="{{ url_for('static', filename='images/boxingshoes.jpg') }}" class="store-pic">
            <h3>Boxing Shoes</h3>
            <p class="price">‚Ç±3,499</p>
            <button class="store-btn" onclick="openPayment('Boxing Shoes', 3499)">Buy Now</button>
        </div>

    </div>
</section>


<!-- ============================
      PAYMENT CHOICE POPUP
=============================== -->
<div id="paymentPopup" class="popup-overlay">
    <div class="popup-box">
        <h3 id="storePopupTitle" class="popup-header"></h3>
        <p>Select a payment method:</p>

        <button class="payment-option-btn" onclick="openStoreGCash()">üì± G-Cash</button>
        <button class="payment-option-btn" onclick="openStoreBank()">üè¶ Online Bank</button>

        <button class="close-btn" onclick="closeAllPopups()">Cancel</button>
    </div>
</div>

<!-- ============================
      STORE G-CASH POPUP
=============================== -->
<div id="storeGCashPopup" class="popup-overlay">
    <div class="popup-box">
        <h3 class="popup-header">G-Cash Payment</h3>

        <img src="{{ url_for('static', filename='images/gcash.jpg') }}" class="qr-image">

        <form method="POST" enctype="multipart/form-data" action="{{ url_for('store_pay') }}">
            <input type="hidden" id="storeProduct" name="product_name">
            <input type="hidden" id="storePrice" name="price">
            <input type="hidden" name="payment_method" value="GCASH">

            <label>Upload G-Cash Proof (jpg, png, pdf):</label>
            <input type="file" name="gcash_proof" accept=".jpg,.png,.pdf" required>

            <button class="proceed-btn" type="submit">Proceed</button>
        </form>

        <button class="close-btn" onclick="closeAllPopups()">Cancel</button>
    </div>
</div>

<!-- ============================
      STORE BANK POPUP
=============================== -->
<div id="storeBankPopup" class="popup-overlay">
    <div class="popup-box">
        <h3 class="popup-header">Online Bank Payment</h3>

        <form method="POST" action="{{ url_for('store_pay') }}">
            <input type="hidden" id="storeProductBank" name="product_name">
            <input type="hidden" id="storePriceBank" name="price">
            <input type="hidden" name="payment_method" value="BANK">

            <label>Full Name:</label>
            <input type="text" name="fullname" required>

            <label>Card Number:</label>
            <input type="text" maxlength="16" pattern="[0-9]{16}" name="card_number" required>

            <label>CVV:</label>
            <input type="text" maxlength="3" pattern="[0-9]{3}" name="cvv" required>

            <button class="proceed-btn" type="submit">Proceed</button>
        </form>

        <button class="close-btn" onclick="closeAllPopups()">Cancel</button>
    </div>
</div>

<script>
// OPEN STORE PAYMENT
let storeProduct = "";
let storePrice = "";

function openPayment(product, price) {
    storeProduct = product;
    storePrice = price;

    document.getElementById("storePopupTitle").innerText =
        `Buy ${product} ‚Äî ‚Ç±${price}`;

    document.getElementById("paymentPopup").style.display = "flex";
}

// OPEN STORE GCASH
function openStoreGCash() {
    document.getElementById("paymentPopup").style.display = "none";

    document.getElementById("storeProduct").value = storeProduct;
    document.getElementById("storePrice").value = storePrice;

    document.getElementById("storeGCashPopup").style.display = "flex";
}

// OPEN BANK
function openStoreBank() {
    document.getElementById("paymentPopup").style.display = "none";

    document.getElementById("storeProductBank").value = storeProduct;
    document.getElementById("storePriceBank").value = storePrice;

    document.getElementById("storeBankPopup").style.display = "flex";
}

function closeAllPopups() {
    document.querySelectorAll(".popup-overlay")
        .forEach(p => p.style.display = "none");
}
</script>

<style>
/* Reuse your membership popup styling */
.popup-overlay {
    position: fixed;
    top:0; left:0;
    width:100%; height:100%;
    display:none;
    justify-content:center;
    align-items:center;
    background: rgba(0,0,0,0.8);
    z-index: 9999;
}
.popup-box {
    background:#111;
    border:3px solid red;
    box-shadow:0 0 20px red;
    padding:20px;
    width:380px;
    color:white;
    border-radius:12px;
    text-align:center;
}
.payment-option-btn,
.proceed-btn,
.close-btn {
    width:100%;
    padding:10px;
    margin-top:10px;
    background:red;
    border:none;
    color:black;
    font-weight:bold;
    border-radius:8px;
    cursor:pointer;
}
.qr-image {
    width:220px;
    display:block;
    margin:10px auto;
}
</style>

{% endblock %}